{{ define "main" }}
    <div class="content">
        <main class="posts">
            <h1>{{ .Title }}</h1>

            {{ if .Content }}
                <div class="projects-intro">{{ .Content }}</div>
            {{ end }}

            {{ $pages := .Pages.ByWeight }}
            {{ $professionalPages := where $pages "Params.category" "eq" "professional" }}
            {{ $personalPages := where $pages "Params.category" "eq" "personal" }}

            {{ if gt (len $professionalPages) 0 }}
                <div class="projects-section">
                    <h2>Professional Projects</h2>
                    <div class="projects-grid">
                        {{ range $professionalPages }}
                            {{ partial "project-card.html" . }}
                        {{ end }}
                    </div>
                </div>
            {{ end }}

            {{ if gt (len $personalPages) 0 }}
                <div class="projects-section">
                    <h2>Personal Projects</h2>
                    <div class="projects-grid">
                        {{ range $personalPages }}
                            {{ partial "project-card.html" . }}
                        {{ end }}
                    </div>
                </div>
            {{ end }}

            {{ $otherPages := $pages | complement $professionalPages | complement $personalPages }}
            {{ if gt (len $otherPages) 0 }}
                <div class="projects-section">
                    <h2>Other Projects</h2>
                    <div class="projects-grid">
                        {{ range $otherPages }}
                            {{ partial "project-card.html" . }}
                        {{ end }}
                    </div>
                </div>
            {{ end }}
        </main>
    </div>
{{ end }}
