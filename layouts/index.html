{{ define "body" }}
    <body class="disable-hor-scroll" style="background: transparent;">
{{ end }}

{{ define "main" }}
    <div class="video-container" style="opacity: 1;">
        <video id="bg-video" autoplay muted loop playsinline webkit-playsinline>
            <source src="{{ "videos/background.mp4" | relURL }}" type="video/mp4">
        </video>
    </div>

    <div class="content">
        <div class="homepage-bg">
            <h1>{{ .Site.Title }}</h1>

            {{ partial "subtitle.html" . }}

            <div class="homepage-buttons">
                <p>
                    <span><a href="{{ "resume" | absLangURL }}"><button>About me</button></a></span> 
                    <span><a href="{{ "projects" | absLangURL }}"><button>My projects</button></a></span>
                </p>
            </div>
        </div>
    </div>

    <script>
            function isMobileDisplay() {
                mQuery = getComputedStyle(document.body).getPropertyValue("--phoneWidth");
                return window.matchMedia(mQuery).matches;
            }

            if (!isMobileDisplay()) {
                document.body.style.background = "transparent";
            }
            
            document.addEventListener("DOMContentLoaded", function () {
                const videoContainer = document.querySelector(".video-container");
                const video = document.getElementById("bg-video");
            
                function playVideo() {
                    videoContainer.style.opacity = "1"; 
                    video.play().catch(error => {
                        console.log("Video autoplay prevented:", error);
                        // Try again after a short delay
                        setTimeout(() => {
                            video.play().catch(err => {
                                console.log("Second attempt failed - hiding video");
                                videoContainer.style.display = "none";
                            });
                        }, 500);
                    });
                }
                
                // Check if video source exists
                video.addEventListener("error", function() {
                    console.log("Video file not found - hiding video container");
                    videoContainer.style.display = "none";
                });
            
                // Force immediate play attempt
                video.play().catch(error => {
                    console.log("Initial play attempt blocked");
                });

                if (video.readyState >= 3) {  
                    playVideo();
                } else {
                    video.onloadeddata = playVideo;
                    video.oncanplaythrough = playVideo;
                }

                // Try to play on any user interaction
                document.body.addEventListener("touchstart", playVideo, { once: true });
                document.body.addEventListener("click", playVideo, { once: true });
            });
        </script>
{{ end }}
